<div class="content-section" id="master-mode">
  <div class="content-header">
    <h2 class="content-title">–®–∞–≥ 1: –í—ã–±–æ—Ä —Ä–µ–∂–∏–º–∞ —Ä–∞–±–æ—Ç—ã</h2>
    <p class="content-description">
      –í—ã–±–µ—Ä–∏—Ç–µ, –≤ –∫–∞–∫–æ–º —Ä–µ–∂–∏–º–µ –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –≤–∞—à —Ä–æ—É—Ç–µ—Ä. –≠—Ç–æ –æ—Å–Ω–æ–≤–Ω–æ–π –ø–∞—Ä–∞–º–µ—Ç—Ä, –∫–æ—Ç–æ—Ä—ã–π –≤–ª–∏—è–µ—Ç –Ω–∞ –≤—Å–µ –æ—Å—Ç–∞–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏.
    </p>
  </div>

  <div class="mode-selection-grid">
    <div class="mode-card active" data-value="router">
      <div class="mode-icon">üì°</div>
      <h3>–†–æ—É—Ç–µ—Ä (Router Mode)</h3>
      <p>–ü–æ–ª–Ω–æ—Ü–µ–Ω–Ω—ã–π —Ä–æ—É—Ç–µ—Ä: NAT, DHCP, firewall, —Ä–∞–∑–¥–∞—á–∞ Wi-Fi –∏ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞.</p>
      <div class="mode-check"></div>
    </div>

    <div class="mode-card" data-value="ap">
      <div class="mode-icon">üì∂</div>
      <h3>–¢–æ—á–∫–∞ –¥–æ—Å—Ç—É–ø–∞ (AP Mode)</h3>
      <p>–¢–æ–ª—å–∫–æ Wi-Fi —Ç–æ—á–∫–∞ –¥–æ—Å—Ç—É–ø–∞ –±–µ–∑ NAT –∏ DHCP. –ü–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –∫ –æ—Å–Ω–æ–≤–Ω–æ–º—É —Ä–æ—É—Ç–µ—Ä—É.</p>
      <div class="mode-check"></div>
    </div>

    <div class="mode-card" data-value="bridge">
      <div class="mode-icon">üåâ</div>
      <h3>–ö–ª–∏–µ–Ω—Ç (Bridge Mode)</h3>
      <p>–†–æ—É—Ç–µ—Ä –∫–∞–∫ Wi-Fi –∞–¥–∞–ø—Ç–µ—Ä –¥–ª—è –ø—Ä–æ–≤–æ–¥–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤ (–±–µ–∑ —Ä–∞–∑–¥–∞—á–∏ Wi-Fi).</p>
      <div class="mode-check"></div>
    </div>

    <div class="mode-card" data-value="wisp">
      <div class="mode-icon">üåê</div>
      <h3>WISP (Wireless ISP)</h3>
      <p>–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –±–µ—Å–ø—Ä–æ–≤–æ–¥–Ω–æ–º—É –ø—Ä–æ–≤–∞–π–¥–µ—Ä—É + —Ä–∞–∑–¥–∞—á–∞ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞ –≤ –¥–æ–º–µ.</p>
      <div class="mode-check"></div>
    </div>
  </div>

  <div id="modeDescription" class="mode-description">
    <strong>–í—ã–±—Ä–∞–Ω —Ä–µ–∂–∏–º:</strong> <span id="selectedModeText">–†–æ—É—Ç–µ—Ä (Router Mode)</span>
  </div>

  <div class="wizard-actions">
    <button class="btn btn-primary next-step">–î–∞–ª–µ–µ ‚Üí</button>
  </div>
</div>

<style>
  .mode-selection-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
    gap: 24px;
    margin: 32px 0;
  }

  .mode-card {
    background: white;
    border: 2px solid #e0e0e0;
    border-radius: 12px;
    padding: 28px 24px;
    cursor: pointer;
    transition: all 0.25s ease;
    position: relative;
    overflow: hidden;
    text-align: center;
    box-shadow: 0 4px 12px rgba(0,0,0,0.05);
  }

  .mode-card:hover {
    border-color: #00a8e0;
    box-shadow: 0 12px 32px rgba(0,168,224,0.18);
    transform: translateY(-6px);
  }

  .mode-card.active {
    border-color: #00a8e0;
    box-shadow: 0 0 0 4px rgba(0,168,224,0.2);
  }

  .mode-icon {
    font-size: 64px;
    margin-bottom: 16px;
    color: #006699;
  }

  .mode-card h3 {
    font-size: 20px;
    color: #004466;
    margin: 0 0 12px;
  }

  .mode-card p {
    color: #555;
    font-size: 14px;
    line-height: 1.5;
    margin: 0;
  }

  .mode-check {
    position: absolute;
    top: 16px;
    right: 16px;
    width: 28px;
    height: 28px;
    border: 2px solid #ccc;
    border-radius: 50%;
    background: white;
    transition: all 0.25s;
  }

  .mode-card.active .mode-check {
    background: #00a8e0;
    border-color: #00a8e0;
  }

  .mode-card.active .mode-check::after {
    content: "‚úì";
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    color: white;
    font-size: 18px;
    font-weight: bold;
  }

  .mode-description {
    background: #e8f4ff;
    border-left: 5px solid #00a8e0;
    padding: 20px 24px;
    border-radius: 0 12px 12px 0;
    margin: 24px 0;
    font-size: 15px;
    color: #333;
    display: none;
  }

  .wizard-actions {
    margin-top: 40px;
    text-align: right;
  }

  .next-step {
    padding: 12px 32px;
    font-size: 16px;
    font-weight: 600;
  }
</style>

<script>
  // –ë–µ–∑ type="module" ‚Äî —á—Ç–æ–±—ã —Ä–∞–±–æ—Ç–∞–ª–æ –¥–∞–∂–µ –ø—Ä–∏ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–π –ø–æ–¥–≥—Ä—É–∑–∫–µ
  (function() {
    // –ñ–¥—ë–º, –ø–æ–∫–∞ —ç–ª–µ–º–µ–Ω—Ç—ã –ø–æ—è–≤—è—Ç—Å—è (–∑–∞—â–∏—Ç–∞ –æ—Ç —Ä–∞–Ω–Ω–µ–≥–æ –∑–∞–ø—É—Å–∫–∞)
    function init() {
      const cards = document.querySelectorAll('#master-mode .mode-card');
      const descBox = document.getElementById('modeDescription');
      const descText = document.getElementById('selectedModeText');
      const nextBtn = document.querySelector('#master-mode .next-step');

      if (!cards.length || !nextBtn) {
        // –ï—Å–ª–∏ –µ—â—ë –Ω–µ –≥–æ—Ç–æ–≤–æ ‚Äî –ø—Ä–æ–±—É–µ–º –ø–æ–∑–∂–µ
        setTimeout(init, 100);
        return;
      }

      console.log('master-mode: —ç–ª–µ–º–µ–Ω—Ç—ã –Ω–∞–π–¥–µ–Ω—ã, –ø—Ä–∏–≤—è–∑—ã–≤–∞–µ–º —Å–æ–±—ã—Ç–∏—è');

      const descriptions = {
        router: "–†–æ—É—Ç–µ—Ä –±—É–¥–µ—Ç —Ä–∞–∑–¥–∞–≤–∞—Ç—å –∏–Ω—Ç–µ—Ä–Ω–µ—Ç, —Å–æ–∑–¥–∞–≤–∞—Ç—å —Å–≤–æ—é –ª–æ–∫–∞–ª—å–Ω—É—é —Å–µ—Ç—å, –≤—ã–¥–∞–≤–∞—Ç—å IP-–∞–¥—Ä–µ—Å–∞ –∏ –∑–∞—â–∏—â–∞—Ç—å —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ —Ñ–∞–π—Ä–≤–æ–ª–æ–º.",
        ap: "–†–æ—É—Ç–µ—Ä –ø—Ä–µ–≤—Ä–∞—â–∞–µ—Ç—Å—è –≤ –æ–±—ã—á–Ω—É—é —Ç–æ—á–∫—É –¥–æ—Å—Ç—É–ø–∞. NAT, DHCP –∏ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è –æ—Ç–∫–ª—é—á–∞—é—Ç—Å—è. –ü–æ–¥–∫–ª—é—á–∞–π—Ç–µ –µ–≥–æ LAN-–ø–æ—Ä—Ç–æ–º –∫ –æ—Å–Ω–æ–≤–Ω–æ–º—É —Ä–æ—É—Ç–µ—Ä—É.",
        bridge: "–†–æ—É—Ç–µ—Ä —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–∞–∫ Wi-Fi –∫–ª–∏–µ–Ω—Ç. –ü–æ–ª–µ–∑–Ω–æ –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è —Ç–µ–ª–µ–≤–∏–∑–æ—Ä–∞, –ü–ö –∏–ª–∏ –ø—Ä–∏—Å—Ç–∞–≤–∫–∏ –±–µ–∑ Wi-Fi –∫ –±–µ—Å–ø—Ä–æ–≤–æ–¥–Ω–æ–π —Å–µ—Ç–∏.",
        wisp: "–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –±–µ—Å–ø—Ä–æ–≤–æ–¥–Ω–æ–º—É –ø—Ä–æ–≤–∞–π–¥–µ—Ä—É + —Ä–∞–∑–¥–∞—á–∞ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞ –ø–æ Wi-Fi –∏ –∫–∞–±–µ–ª—é –≤ –¥–æ–º–µ."
      };

      let selectedValue = 'router';

      function updateDescription(value) {
        if (descBox && descText) {
          descText.textContent = descriptions[value] || '–í—ã–±–µ—Ä–∏—Ç–µ —Ä–µ–∂–∏–º';
          descBox.style.display = 'block';
        }
      }

      cards.forEach(card => {
        card.addEventListener('click', () => {
          cards.forEach(c => c.classList.remove('active'));
          card.classList.add('active');
          selectedValue = card.dataset.value;
          updateDescription(selectedValue);
        });
      });

      // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –Ω–∞—á–∞–ª—å–Ω–æ–µ
      updateDescription(selectedValue);

      // –ö–Ω–æ–ø–∫–∞ –î–∞–ª–µ–µ ‚Äî –ø—Ä–æ—Å—Ç–æ —Å–æ–æ–±—â–µ–Ω–∏–µ + –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞
      nextBtn.addEventListener('click', () => {
        if (!selectedValue) {
          alert('–í—ã–±–µ—Ä–∏—Ç–µ —Ä–µ–∂–∏–º —Ä–∞–±–æ—Ç—ã');
          return;
        }

        localStorage.setItem('selectedRouterMode', selectedValue);

        alert(`–†–µ–∂–∏–º –∏–∑–º–µ–Ω—ë–Ω –Ω–∞: ${selectedValue}\n–†–æ—É—Ç–µ—Ä –±—É–¥–µ—Ç –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∂–µ–Ω.`);

        // –ó–∞–ø—É—Å–∫–∞–µ–º –∞–Ω–∏–º–∞—Ü–∏—é –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏ (–∫–∞–∫ –≤ wizard.js)
        const container = document.getElementById('wizardContainer');
        if (!container) {
          alert('–ù–µ –Ω–∞–π–¥–µ–Ω –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –º–∞—Å—Ç–µ—Ä–∞');
          return;
        }

        const current = document.querySelector('#master-mode');
        if (current) current.style.display = 'none';

        const reboot = document.createElement('div');
        reboot.style.cssText = `
          text-align: center;
          padding: 80px 30px;
          background: linear-gradient(135deg, #f0f4f8, #e0eaff);
          border-radius: 16px;
          box-shadow: 0 10px 30px rgba(0,102,153,0.15);
          max-width: 700px;
          margin: 60px auto;
        `;
        reboot.innerHTML = `
          <h2 style="color:#004466;font-size:28px;margin-bottom:20px;">–†–µ–∂–∏–º –∏–∑–º–µ–Ω—ë–Ω!</h2>
          <div style="margin:40px 0;height:120px;position:relative;">
            <div style="width:80px;height:80px;border:8px solid #e0e0e0;border-top:8px solid #00a8e0;border-radius:50%;animation:spin 1.2s linear infinite;position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);"></div>
          </div>
          <p style="font-size:18px;color:#555;margin:20px 0 40px;">
            –†–æ—É—Ç–µ—Ä –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è...<br>–ü–æ–¥–æ–∂–¥–∏—Ç–µ 30‚Äì60 —Å–µ–∫—É–Ω–¥.
          </p>
          <div id="countdown" style="font-size:48px;font-weight:bold;color:#006699;margin:20px 0;">15</div>
          <p style="color:#777;font-size:16px;">–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –≤–æ–∑–≤—Ä–∞—Ç —á–µ—Ä–µ–∑ <span id="sec">15</span> —Å–µ–∫...</p>
        `;
        container.appendChild(reboot);

        let sec = 15;
        const cd = reboot.querySelector('#countdown');
        const st = reboot.querySelector('#sec');

        const timer = setInterval(() => {
          sec--;
          if (cd) cd.textContent = sec;
          if (st) st.textContent = sec;
          if (sec <= 0) {
            clearInterval(timer);
            reboot.innerHTML = `
              <div style="padding:60px 20px;">
                <div style="font-size:80px;color:#28a745;margin-bottom:30px;">‚úî</div>
                <h2 style="color:#28a745;font-size:32px;margin-bottom:20px;">–ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞</h2>
                <p style="font-size:18px;color:#444;margin-bottom:40px;">
                  –†–æ—É—Ç–µ—Ä –∑–∞–ø—É—â–µ–Ω –≤ —Ä–µ–∂–∏–º–µ: ${selectedValue}
                </p>
                <p style="font-size:16px;color:#666;">–í–æ–∑–≤—Ä–∞—Ç –Ω–∞ –Ω–∞—á–∞–ª—å–Ω—ã–π —ç–∫—Ä–∞–Ω —á–µ—Ä–µ–∑ 4 —Å–µ–∫—É–Ω–¥—ã...</p>
              </div>
            `;

            setTimeout(() => {
              const welcome = document.getElementById('welcomeScreen');
              const container = document.getElementById('wizardContainer');
              if (welcome) welcome.style.display = 'block';
              if (container) {
                container.style.display = 'none';
                container.querySelectorAll('.wizard-step, .content-section').forEach(el => {
                  el.style.display = 'none';
                  el.classList.remove('active');
                });
                const step1 = container.querySelector('#step1, #master-mode');
                if (step1) step1.classList.add('active');
              }
              reboot.remove();
              alert('–†–æ—É—Ç–µ—Ä –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∂–µ–Ω. –ú–∞—Å—Ç–µ—Ä –≥–æ—Ç–æ–≤ –∫ –Ω–æ–≤–æ–º—É –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é.');
            }, 4000);
          }
        }, 1000);
      });
    }

    // –ó–∞–ø—É—Å–∫–∞–µ–º —Å –Ω–µ–±–æ–ª—å—à–æ–π –∑–∞–¥–µ—Ä–∂–∫–æ–π (—á—Ç–æ–±—ã DOM –±—ã–ª –≥–æ—Ç–æ–≤)
    setTimeout(init, 200);
  })();
</script>