<div class="content-section active">
  <div class="content-header">
    <h2 class="content-title">Настройка объявления маршрутизатора</h2>
    <p class="content-description">
      Настройка параметров Router Advertisement (RA) для IPv6 префиксов.
    </p>
  </div>

  <!-- Префикс 1 -->
  <div class="prefix-section">
    <h3 class="prefix-title">Префикс 1</h3>
    
    <div class="form-row">
      <div class="form-label">Статус:</div>
      <div class="form-field">
        <label class="checkbox-label">
          <input type="checkbox" id="prefix1-enabled" checked>
          <span>Включено</span>
        </label>
      </div>
    </div>

    <div class="form-row">
      <div class="form-label">Префикс:</div>
      <div class="form-field">
        <div class="field-with-hint">
          <input type="text" class="form-control" id="prefix1-prefix" value="fd00::/64" placeholder="IPv6 префикс">
          <span class="hint">/64</span>
        </div>
      </div>
    </div>

    <div class="form-row">
      <div class="form-label">Флаг объявления на ссылке:</div>
      <div class="form-field">
        <label class="checkbox-label">
          <input type="checkbox" id="prefix1-onlink">
          <span>Включено (on-link)</span>
        </label>
        <div class="field-hint" style="margin-top: 4px; color: #666; font-size: 12px;">
          Указывает, что префикс находится на этой ссылке
        </div>
      </div>
    </div>

    <div class="form-row">
      <div class="form-label">Флаг автономного объявления:</div>
      <div class="form-field">
        <label class="checkbox-label">
          <input type="checkbox" id="prefix1-autonomous" checked>
          <span>Включено (autonomous)</span>
        </label>
        <div class="field-hint" style="margin-top: 4px; color: #666; font-size: 12px;">
          Разрешает автономную конфигурацию адресов (SLAAC)
        </div>
      </div>
    </div>

    <div class="form-row">
      <div class="form-label">Время жизни объявления:</div>
      <div class="form-field">
        <div class="field-with-hint">
          <input type="number" class="form-control" id="prefix1-lifetime" value="1200" min="0" max="86400" style="width: 150px;">
          <span class="hint">секунд</span>
        </div>
        <div class="field-hint" style="color: #666; font-size: 12px;">
          Время действия префикса (0-86400)
        </div>
      </div>
    </div>

    <div class="form-row">
      <div class="form-label">Предпочтительное время жизни объявления:</div>
      <div class="form-field">
        <div class="field-with-hint">
          <input type="number" class="form-control" id="prefix1-preferred" value="600" min="0" max="86400" style="width: 150px;">
          <span class="hint">секунд</span>
        </div>
        <div class="field-hint" style="color: #666; font-size: 12px;">
          Предпочтительное время действия (должно быть ≤ времени жизни)
        </div>
      </div>
    </div>

    <div class="form-row">
      <div class="form-label">Адрес маршрутизатора объявления:</div>
      <div class="form-field">
        <input type="text" class="form-control" id="prefix1-router-addr" value="fd00::1" placeholder="IPv6 адрес">
      </div>
    </div>
  </div>

  <!-- Разделитель между префиксами -->
  <hr class="section-divider">

  <!-- Префикс 2 -->
  <div class="prefix-section">
    <h3 class="prefix-title">Префикс 2</h3>
    
    <div class="form-row">
      <div class="form-label">Статус:</div>
      <div class="form-field">
        <label class="checkbox-label">
          <input type="checkbox" id="prefix2-enabled">
          <span>Включено</span>
        </label>
      </div>
    </div>

    <div class="form-row">
      <div class="form-label">Префикс:</div>
      <div class="form-field">
        <div class="field-with-hint">
          <input type="text" class="form-control" id="prefix2-prefix" value="2001:db8::/64" placeholder="IPv6 префикс">
          <span class="hint">/64</span>
        </div>
      </div>
    </div>

    <div class="form-row">
      <div class="form-label">Флаг объявления на ссылке:</div>
      <div class="form-field">
        <label class="checkbox-label">
          <input type="checkbox" id="prefix2-onlink">
          <span>Включено (on-link)</span>
        </label>
      </div>
    </div>

    <div class="form-row">
      <div class="form-label">Флаг автономного объявления:</div>
      <div class="form-field">
        <label class="checkbox-label">
          <input type="checkbox" id="prefix2-autonomous" checked>
          <span>Включено (autonomous)</span>
        </label>
      </div>
    </div>

    <div class="form-row">
      <div class="form-label">Время жизни объявления:</div>
      <div class="form-field">
        <div class="field-with-hint">
          <input type="number" class="form-control" id="prefix2-lifetime" value="1200" min="0" max="86400" style="width: 150px;">
          <span class="hint">секунд</span>
        </div>
      </div>
    </div>

    <div class="form-row">
      <div class="form-label">Предпочтительное время жизни объявления:</div>
      <div class="form-field">
        <div class="field-with-hint">
          <input type="number" class="form-control" id="prefix2-preferred" value="600" min="0" max="86400" style="width: 150px;">
          <span class="hint">секунд</span>
        </div>
      </div>
    </div>

    <div class="form-row">
      <div class="form-label">Адрес маршрутизатора объявления:</div>
      <div class="form-field">
        <input type="text" class="form-control" id="prefix2-router-addr" value="2001:db8::1" placeholder="IPv6 адрес">
      </div>
    </div>
  </div>

  <!-- Кнопки внизу -->
  <div class="form-row" style="margin-top: 40px;">
    <div class="form-label"></div>
    <div class="form-field">
      <div class="button-group">
        <button class="btn btn-secondary" id="saveBtn">Сохранить</button>
        <button class="btn btn-primary" id="saveApplyBtn">Сохранить и применить</button>
        <button class="btn btn-secondary" id="defaultBtn">По умолчанию</button>
        <button class="btn btn-danger" id="resetBtn">Сбросить</button>
      </div>
    </div>
  </div>
</div>

<style>
  /* Унифицированные стили в соответствии с предыдущими страницами */
  * {
    box-sizing: border-box;
  }

  .content-section {
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Arial, sans-serif;
    max-width: 1000px;
    margin: 0 auto;
    padding: 20px;
    background: #fff;
    border-radius: 8px;
    box-shadow: 0 2px 8px rgba(0,0,0,0.05);
  }

  .content-header {
    margin-bottom: 24px;
  }

  .content-title {
    font-size: 20px;
    color: #004466;
    margin: 0 0 8px 0;
    font-weight: 600;
  }

  .content-description {
    font-size: 14px;
    color: #555;
    line-height: 1.5;
    margin: 0;
    padding-bottom: 16px;
    border-bottom: 1px solid #e0e8f0;
  }

  .prefix-section {
    margin-bottom: 30px;
  }

  .prefix-title {
    color: #004466;
    font-size: 16px;
    margin-bottom: 16px;
    padding-bottom: 6px;
    border-bottom: 1px solid #d0e0f0;
    font-weight: 600;
  }

  .section-divider {
    margin: 30px 0;
    border: none;
    border-top: 2px dashed #c0d0e0;
  }

  .form-row {
    display: flex;
    align-items: flex-start;
    margin-bottom: 16px;
    padding: 4px 0;
  }

  .form-label {
    width: 280px;
    font-weight: 600;
    color: #004466;
    font-size: 14px;
    padding-top: 8px;
    flex-shrink: 0;
  }

  .form-field {
    flex: 1;
    max-width: 600px;
  }

  .form-control {
    padding: 8px 12px;
    border: 1px solid #b0c0d0;
    border-radius: 6px;
    font-size: 14px;
    background: #fff;
    transition: border-color 0.2s, box-shadow 0.2s;
    height: 38px;
    width: 100%;
  }

  .form-control:focus {
    border-color: #006699;
    outline: none;
    box-shadow: 0 0 0 3px rgba(0,102,153,0.1);
  }

  .form-control::placeholder {
    color: #99a8b9;
    font-style: italic;
  }

  input[type="number"].form-control {
    -moz-appearance: textfield;
  }

  input[type="number"].form-control::-webkit-outer-spin-button,
  input[type="number"].form-control::-webkit-inner-spin-button {
    -webkit-appearance: none;
    margin: 0;
  }

  .field-with-hint {
    display: flex;
    align-items: center;
    gap: 12px;
    flex-wrap: wrap;
  }

  .hint {
    font-size: 13px;
    color: #666;
    background: #f5f7fa;
    padding: 4px 10px;
    border-radius: 16px;
    border: 1px solid #e0e8f0;
    white-space: nowrap;
  }

  .field-hint {
    font-size: 12px;
    color: #666;
    line-height: 1.4;
  }

  .checkbox-label {
    display: inline-flex;
    align-items: center;
    gap: 8px;
    font-size: 14px;
    color: #333;
    cursor: pointer;
    user-select: none;
    background: #f8fafc;
    padding: 8px 16px;
    border-radius: 6px;
    border: 1px solid #e0e8f0;
    transition: all 0.2s;
  }

  .checkbox-label:hover {
    background: #eef2f6;
    border-color: #b0c0d0;
  }

  .checkbox-label input[type="checkbox"] {
    width: 16px;
    height: 16px;
    margin: 0;
    cursor: pointer;
  }

  .button-group {
    display: flex;
    gap: 12px;
    flex-wrap: wrap;
  }

  .btn {
    padding: 8px 20px;
    border: 1px solid transparent;
    border-radius: 6px;
    font-size: 14px;
    font-weight: 500;
    cursor: pointer;
    transition: all 0.2s;
    height: 38px;
    white-space: nowrap;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    gap: 6px;
  }

  .btn-secondary {
    background: #f0f4f8;
    border-color: #b0c0d0;
    color: #004466;
  }

  .btn-secondary:hover {
    background: #e4eaf2;
    border-color: #90a0b8;
  }

  .btn-primary {
    background: #006699;
    border-color: #004466;
    color: white;
  }

  .btn-primary:hover {
    background: #004466;
  }

  .btn-danger {
    background: #f8f0f0;
    border-color: #d0b0b0;
    color: #993333;
  }

  .btn-danger:hover {
    background: #f0e0e0;
    border-color: #b09090;
  }

  /* Адаптивность */
  @media (max-width: 768px) {
    .form-row {
      flex-direction: column;
      align-items: stretch;
    }

    .form-label {
      width: 100%;
      margin-bottom: 4px;
    }

    .field-with-hint {
      flex-direction: column;
      align-items: flex-start;
    }

    .hint {
      align-self: flex-start;
    }

    .button-group {
      flex-direction: column;
    }

    .btn {
      width: 100%;
    }

    .checkbox-label {
      width: 100%;
      justify-content: center;
    }
  }

  /* Уведомления */
  .notification {
    position: fixed;
    bottom: 20px;
    right: 20px;
    background: #d4edda;
    color: #155724;
    padding: 12px 24px;
    border-radius: 8px;
    box-shadow: 0 4px 12px rgba(0,0,0,0.15);
    z-index: 10000;
    display: flex;
    align-items: center;
    gap: 10px;
    font-weight: 500;
    animation: slideIn 0.3s ease;
  }

  @keyframes slideIn {
    from {
      transform: translateX(100%);
      opacity: 0;
    }
    to {
      transform: translateX(0);
      opacity: 1;
    }
  }
</style>

<script>
(function() {
  // Элементы DOM
  const saveBtn = document.getElementById('saveBtn');
  const saveApplyBtn = document.getElementById('saveApplyBtn');
  const defaultBtn = document.getElementById('defaultBtn');
  const resetBtn = document.getElementById('resetBtn');

  // Функция показа уведомлений
  const showNotification = (message, isError = false) => {
    const notification = document.createElement('div');
    notification.className = 'notification';
    notification.style.background = isError ? '#f8d7da' : '#d4edda';
    notification.style.color = isError ? '#721c24' : '#155724';
    notification.innerHTML = `
      <span>${isError ? '✕' : '✓'}</span>
      <span>${message}</span>
    `;
    document.body.appendChild(notification);
    
    setTimeout(() => {
      notification.style.opacity = '0';
      notification.style.transform = 'translateX(100%)';
      setTimeout(() => {
        if (notification.parentNode) {
          notification.remove();
        }
      }, 300);
    }, 3000);
  };

  // Сбор настроек
  const collectSettings = () => {
    return {
      prefix1: {
        enabled: document.getElementById('prefix1-enabled')?.checked || false,
        prefix: document.getElementById('prefix1-prefix')?.value || '',
        onlink: document.getElementById('prefix1-onlink')?.checked || false,
        autonomous: document.getElementById('prefix1-autonomous')?.checked || false,
        lifetime: parseInt(document.getElementById('prefix1-lifetime')?.value) || 1200,
        preferred: parseInt(document.getElementById('prefix1-preferred')?.value) || 600,
        routerAddr: document.getElementById('prefix1-router-addr')?.value || ''
      },
      prefix2: {
        enabled: document.getElementById('prefix2-enabled')?.checked || false,
        prefix: document.getElementById('prefix2-prefix')?.value || '',
        onlink: document.getElementById('prefix2-onlink')?.checked || false,
        autonomous: document.getElementById('prefix2-autonomous')?.checked || false,
        lifetime: parseInt(document.getElementById('prefix2-lifetime')?.value) || 1200,
        preferred: parseInt(document.getElementById('prefix2-preferred')?.value) || 600,
        routerAddr: document.getElementById('prefix2-router-addr')?.value || ''
      }
    };
  };

  // Сохранение
  if (saveBtn) {
    saveBtn.addEventListener('click', (e) => {
      e.preventDefault();
      const settings = collectSettings();
      console.log('Настройки RA сохранены:', settings);
      showNotification('Настройки сохранены');
    });
  }

  // Сохранить и применить
  if (saveApplyBtn) {
    saveApplyBtn.addEventListener('click', (e) => {
      e.preventDefault();
      const settings = collectSettings();
      console.log('Настройки RA применены:', settings);
      showNotification('Настройки сохранены и применены');
    });
  }

  // По умолчанию
  if (defaultBtn) {
    defaultBtn.addEventListener('click', (e) => {
      e.preventDefault();
      
      // Префикс 1 остается включенным
      document.getElementById('prefix1-enabled').checked = true;
      document.getElementById('prefix1-prefix').value = 'fd00::/64';
      document.getElementById('prefix1-onlink').checked = false;
      document.getElementById('prefix1-autonomous').checked = true;
      document.getElementById('prefix1-lifetime').value = '1200';
      document.getElementById('prefix1-preferred').value = '600';
      document.getElementById('prefix1-router-addr').value = 'fd00::1';

      // Префикс 2 выключен по умолчанию
      document.getElementById('prefix2-enabled').checked = false;
      document.getElementById('prefix2-prefix').value = '2001:db8::/64';
      document.getElementById('prefix2-onlink').checked = false;
      document.getElementById('prefix2-autonomous').checked = true;
      document.getElementById('prefix2-lifetime').value = '1200';
      document.getElementById('prefix2-preferred').value = '600';
      document.getElementById('prefix2-router-addr').value = '2001:db8::1';

      showNotification('Установлены настройки по умолчанию');
    });
  }

  // Сброс
  if (resetBtn) {
    resetBtn.addEventListener('click', (e) => {
      e.preventDefault();
      
      // Полный сброс к исходным значениям
      document.getElementById('prefix1-enabled').checked = true;
      document.getElementById('prefix1-prefix').value = 'fd00::/64';
      document.getElementById('prefix1-onlink').checked = false;
      document.getElementById('prefix1-autonomous').checked = true;
      document.getElementById('prefix1-lifetime').value = '1200';
      document.getElementById('prefix1-preferred').value = '600';
      document.getElementById('prefix1-router-addr').value = 'fd00::1';

      document.getElementById('prefix2-enabled').checked = false;
      document.getElementById('prefix2-prefix').value = '2001:db8::/64';
      document.getElementById('prefix2-onlink').checked = false;
      document.getElementById('prefix2-autonomous').checked = true;
      document.getElementById('prefix2-lifetime').value = '1200';
      document.getElementById('prefix2-preferred').value = '600';
      document.getElementById('prefix2-router-addr').value = '2001:db8::1';

      showNotification('Настройки сброшены');
    });
  }

  // Валидация числовых полей
  const numericInputs = document.querySelectorAll('input[type="number"]');
  numericInputs.forEach(input => {
    input.addEventListener('input', function() {
      const min = parseInt(this.min) || 0;
      const max = parseInt(this.max) || Infinity;
      let value = parseInt(this.value);
      
      if (isNaN(value)) {
        this.value = min;
      } else if (value < min) {
        this.value = min;
      } else if (value > max) {
        this.value = max;
      }
    });
  });

  // Проверка соотношения preferred ≤ lifetime
  const validatePreferred = (lifetimeId, preferredId) => {
    const lifetime = document.getElementById(lifetimeId);
    const preferred = document.getElementById(preferredId);
    
    if (lifetime && preferred) {
      const check = () => {
        const life = parseInt(lifetime.value) || 0;
        const pref = parseInt(preferred.value) || 0;
        
        if (pref > life) {
          preferred.value = life;
          showNotification('Предпочтительное время не может превышать время жизни', true);
        }
      };
      
      lifetime.addEventListener('input', check);
      preferred.addEventListener('input', check);
    }
  };

  validatePreferred('prefix1-lifetime', 'prefix1-preferred');
  validatePreferred('prefix2-lifetime', 'prefix2-preferred');

  // Добавляем анимации
  if (!document.getElementById('ra-prefix-animations')) {
    const style = document.createElement('style');
    style.id = 'ra-prefix-animations';
    style.textContent = `
      @keyframes slideIn {
        from {
          transform: translateX(100%);
          opacity: 0;
        }
        to {
          transform: translateX(0);
          opacity: 1;
        }
      }
    `;
    document.head.appendChild(style);
  }
})();
</script>